import{_ as T}from"./pFQ3WpCd.js";import{_ as V}from"./Bd82VzQZ.js";import{H as b,d as k,v as n,x as u,L as I,M as q,y as $,z as F,R as M,u as A,r as d,j as l,S as j,I as z,F as g,B as D,A as L,G as a,Q as E,J as S}from"./B9oDE-Kx.js";import{_ as G}from"./CU9fIaa6.js";import{S as y,s as J}from"./DgTxzoKL.js";import{k as K}from"./D_sfbCPW.js";import{L as p}from"./DXt85jR_.js";import"./DlAUqK2U.js";const Q=10,U=b("search",{state:()=>({searchList:[],searchListTotalPages:0,loaded:!1,searchHistory:p.get(y.searchHistory)||[]}),getters:{finalSearchList(o){return J(o.searchList)}},actions:{clearHistory(){this.searchHistory=[],p.removeItem(y.searchHistory)},writeToHistory(o){const s=this.searchHistory.findIndex(t=>t===o);if(s!==-1){this.searchHistory.push(...this.searchHistory.splice(s,1));return}this.searchHistory.length>=Q&&this.searchHistory.shift(),this.searchHistory.push(o),p.set(y.searchHistory,this.searchHistory)},findByName(o,s){const t=o.trim();this.$state.loaded=!0,s===1&&(this.$state.searchList=[]),K.getByKeyword(t,s).then(e=>{this.$state.searchList=[...this.$state.searchList,...e.items],this.$state.searchListTotalPages=Math.ceil(e.searchFilmsCountResult/s),this.writeToHistory(t),this.$state.loaded=!1})}}}),O={class:"flex flex-wrap items-center gap-x-1 gap-y-1 mb-6"},W=$("span",null,"–ù–µ–¥–∞–≤–Ω–æ –∏—Å–∫–∞–ª–∏:",-1),X=["onClick"],Y=k({__name:"SearchHistory",props:{history:{}},emits:["clearHistory","research"],setup(o,{emit:s}){const t=s;return(e,r)=>(n(),u("div",O,[W,(n(!0),u(I,null,q(e.history,i=>(n(),u("span",{key:i,class:"text-white/70 inline-block hover:underline py-1 px-2 rounded-md bg-black/40 cursor-pointer",onClick:h=>t("research",i)},F(i),9,X))),128)),$("span",{class:"underline cursor-pointer text-white/80",onClick:r[0]||(r[0]=i=>t("clearHistory"))}," –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é ")]))}}),Z={key:1,class:"text-3xl xl:text-4xl text-center"},ce=k({__name:"index",setup(o){const s=M(),t=A(),e=d(""),r=U(),i=l(()=>r.finalSearchList),h=l(()=>s.query.s),f=l(()=>r.loaded),_=d(!1),c=d(0),C=l(()=>r.searchListTotalPages),v=l(()=>r.searchHistory.toReversed());j(()=>{h.value&&(e.value=`${h.value}`,m())});const m=()=>{e.value.trim()&&(c.value=1,_.value=!0,t.push({query:{...s.query,s:e.value}}))},w=x=>{e.value=x,m()};z(()=>[c.value,h.value],()=>{r.findByName(e.value,c.value)});const B=()=>{C.value<=c.value||c.value++};return(x,H)=>{const P=T,R=V;return n(),g(R,{class:"pt-24 flex flex-col items-center"},{default:D(()=>[L(P,{class:"w-full sm:w-1/2 mb-6",modelValue:a(e),"onUpdate:modelValue":H[0]||(H[0]=N=>E(e)?e.value=N:null),onSearch:m},null,8,["modelValue"]),a(v).length?(n(),g(Y,{key:0,history:a(v),onClearHistory:a(r).clearHistory,onResearch:w},null,8,["history","onClearHistory"])):S("",!0),L(G,{class:"self-stretch","movie-list":a(i),"is-loaded":a(f),onPagination:B},null,8,["movie-list","is-loaded"]),!a(i).length&&!a(f)&&a(_)?(n(),u("div",Z," –ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üò¢ ")):S("",!0)]),_:1})}}});export{ce as default};
